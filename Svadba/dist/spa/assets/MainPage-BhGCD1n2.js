import{e as f,Q as u}from"./QBtn-BNH2FAX7.js";import{g as C,c as P,Q as U,a as g,b as m,d as F,e as I,f as L}from"./QPage-48eQ5I7A.js";import{Q}from"./use-prevent-scroll-DOC8rxdB.js";import{p as T,k as j,_ as S,I as v,J as p,K as c,O as o,M as l,P as h,Q as y,R as x,S as _,T as D,m as N,U as k,V as E,N as w}from"./index-CmSL8_Ea.js";function b(t){if(t===!1)return 0;if(t===!0||t===void 0)return 1;const e=parseInt(t,10);return isNaN(e)?0:e}const O=T({name:"close-popup",beforeMount(t,{value:e}){const s={depth:b(e),handler(n){s.depth!==0&&setTimeout(()=>{const a=C(t);a!==void 0&&P(a,n,s.depth)})},handlerKey(n){j(n,13)===!0&&s.handler(n)}};t.__qclosepopup=s,t.addEventListener("click",s.handler),t.addEventListener("keyup",s.handlerKey)},updated(t,{value:e,oldValue:s}){e!==s&&(t.__qclosepopup.depth=b(e))},beforeUnmount(t){const e=t.__qclosepopup;t.removeEventListener("click",e.handler),t.removeEventListener("keyup",e.handlerKey),delete t.__qclosepopup}}),R={name:"WeddingUploadPage",mounted(){localStorage.setItem("nav_value","camera")},data(){return{successDialog:!1,selectedFiles:[],previews:[],isUploading:!1,uploadProgress:0}},methods:{selectFiles(){this.$refs.fileInput.click()},goToGallery(){this.$router.push("/gallery")},previewFiles(t){const e=Array.from(t.target.files);this.selectedFiles.push(...e),this.previews.push(...e.map(s=>URL.createObjectURL(s)))},removeImage(t){URL.revokeObjectURL(this.previews[t]),this.selectedFiles.splice(t,1),this.previews.splice(t,1)},async addImageToEvent(t,e){const s=await fetch("https://bojan.pythonanywhere.com/add_event",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({event_name:t,ImageURL:e})});if(!s.ok){const n=await s.json();throw new Error(n.error||"Backend error")}return s.json()},async uploadFiles(){if(!this.selectedFiles.length){alert("Ð’Ðµ Ð¼Ð¾Ð»Ð°Ð¼, Ð¿Ñ€Ð²Ð¾ Ð¸Ð·Ð±ÐµÑ€ÐµÑ‚Ðµ Ð½ÐµÐºÐ¾Ð¸ ÑÐ»Ð¸ÐºÐ¸.");return}const t=this.selectedFiles.slice(0,20),e=t.map(s=>s.name);this.isUploading=!0,this.uploadProgress=0;try{const n=await(await fetch("https://mjvwsyxyzc.execute-api.eu-north-1.amazonaws.com/default/svadbaLambdaFunction",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({filenames:e})})).json();let a=0;for(let i=0;i<t.length;i++){const r=t[i],d=n.urls[i]?.upload_url;if(!d)continue;(await fetch(d,{method:"PUT",headers:{"Content-Type":r.type},body:r})).ok&&await this.addImageToEvent("Svadba",r.name),a++,this.uploadProgress=a/t.length*100}this.successDialog=!0,this.previews.forEach(URL.revokeObjectURL),this.previews=[],this.selectedFiles=[],this.$refs.fileInput.value=""}catch(s){alert("ÐÐµÑƒÑÐ¿ÐµÑˆÐ½Ð¾ Ð¿Ñ€Ð¸ÐºÐ°Ñ‡ÑƒÐ²Ð°ÑšÐµ. ÐžÐ±Ð¸Ð´ÐµÑ‚Ðµ ÑÐµ Ð¿Ð¾Ð²Ñ‚Ð¾Ñ€Ð½Ð¾."),console.error(s)}finally{this.isUploading=!1,this.uploadProgress=0}}}},V={class:"text-center"},z={class:"row q-col-gutter-md justify-center"},B={class:"text-center q-mt-md"},K={key:0,class:"overlay"},M={class:"loader-container column items-center"},J={class:"hearts-loader"},A={class:"progress-container q-mt-md"},G={class:"text-caption text-pink-8 q-mt-xs"};function W(t,e,s,n,a,i){return p(),v(U,{class:"wedding-page column flex flex-center"},{default:c(()=>[e[6]||(e[6]=o("div",{class:"hero q-pa-sm column flex flex-center"},[o("h1",{class:"text-h4 text-bold text-gold q-mt-md wedding-title"}," Ð’Ð°Ð»ÐµÐ½Ñ‚Ð¸Ð½Ð° & Ð‘ÐµÑ€Ðº "),o("div",{class:"text-subtitle2 text-grey-9 q-mt-xs"}," ðŸ’ Ð¡Ð²Ð°Ð´Ð±ÐµÐ½Ð¸ ÑÐ¿Ð¾Ð¼ÐµÐ½Ð¸ â€“ 2025 ")],-1)),l(g,{flat:"",bordered:"",class:"upload-card q-mt-xl q-pa-md"},{default:c(()=>[l(m,null,{default:c(()=>[o("div",V,[l(f,{name:"photo_camera",size:"40px",class:"text-pink-6"}),e[2]||(e[2]=o("h2",{class:"text-h6 text-bold q-mt-sm"},"Ð¡Ð¿Ð¾Ð´ÐµÐ»Ð¸ ÑÐ»Ð¸ÐºÐ¸",-1)),e[3]||(e[3]=o("p",{class:"text-body2 text-grey-7 q-mt-xs"}," Ð¢Ð²Ð¾Ð¸Ñ‚Ðµ ÑÐ»Ð¸ÐºÐ¸ ÑÐµ Ð´ÐµÐ» Ð¾Ð´ Ð½Ð°ÑˆÐ°Ñ‚Ð° Ð¿Ñ€Ð¸ÐºÐ°Ð·Ð½Ð°. Ð¡Ð¿Ð¾Ð´ÐµÐ»Ð¸ Ð³Ð¸ ÑÐ¾ Ð½Ð°Ñ, Ð·Ð° Ð´Ð° Ð³Ð¸ Ð¿Ð¾Ð¼Ð½Ð¸Ð¼Ðµ Ð·Ð°ÑÐµÐºÐ¾Ð³Ð°Ñˆ. ",-1))])]),_:1}),l(F,{spaced:""}),l(m,{class:"text-center"},{default:c(()=>[l(u,{color:"pink-6","text-color":"white",label:"Ð˜Ð·Ð±ÐµÑ€Ð¸ ÑÐ»Ð¸ÐºÐ¸",icon:"photo_camera",onClick:i.selectFiles},null,8,["onClick"]),o("input",{ref:"fileInput",type:"file",accept:"image/*",multiple:"",style:{display:"none"},onChange:e[0]||(e[0]=(...r)=>i.previewFiles&&i.previewFiles(...r))},null,544)]),_:1}),a.previews.length?(p(),v(m,{key:0},{default:c(()=>[o("div",z,[(p(!0),h(x,null,_(a.previews,(r,d)=>(p(),h("div",{key:d,class:D(["col-4 q-mb-md relative-position preview-img",{dimmed:d>=20}])},[l(Q,{src:r,"spinner-color":"pink-6",style:{"border-radius":"12px",height:"100px","object-fit":"cover"}},null,8,["src"]),l(u,{dense:"",round:"",flat:"",color:"negative",icon:"close",size:"sm",class:"remove-btn",onClick:q=>i.removeImage(d)},null,8,["onClick"])],2))),128))]),o("div",B,[l(u,{color:"pink-6","text-color":"white",label:"Ð˜ÑÐ¿Ñ€Ð°Ñ‚Ð¸ ÑÐ»Ð¸ÐºÐ¸",icon:"send",onClick:i.uploadFiles},null,8,["onClick"])])]),_:1})):y("",!0)]),_:1}),l(I,{modelValue:a.successDialog,"onUpdate:modelValue":e[1]||(e[1]=r=>a.successDialog=r)},{default:c(()=>[l(g,{class:"q-pa-md text-center"},{default:c(()=>[l(m,null,{default:c(()=>[l(f,{name:"check_circle",size:"48px",class:"text-green-6 q-mb-sm"}),e[4]||(e[4]=o("div",{class:"text-h6 text-bold"},"Ð¡Ð»Ð¸ÐºÐ¸Ñ‚Ðµ ÑÐµ Ð¿Ñ€Ð¸ÐºÐ°Ñ‡ÐµÐ½Ð¸! ðŸŽ‰",-1)),e[5]||(e[5]=o("p",{class:"text-body2 text-grey-8 q-mt-xs"}," Ð¢Ð¸ Ð±Ð»Ð°Ð³Ð¾Ð´Ð°Ñ€Ð¸Ð¼Ðµ ÑˆÑ‚Ð¾ Ð³Ð¸ ÑÐ¿Ð¾Ð´ÐµÐ»Ð¸ Ñ‚Ð²Ð¾Ð¸Ñ‚Ðµ ÑÐ¿Ð¾Ð¼ÐµÐ½Ð¸ ÑÐ¾ Ð½Ð°Ñ! ",-1))]),_:1}),l(L,{align:"center"},{default:c(()=>[N(l(u,{flat:"",color:"pink-6",label:"Ð—Ð°Ñ‚Ð²Ð¾Ñ€Ð¸"},null,512),[[O]])]),_:1})]),_:1})]),_:1},8,["modelValue"]),a.isUploading?(p(),h("div",K,[o("div",M,[o("div",J,[(p(),h(x,null,_(3,r=>o("div",{class:"heart",key:r,style:k({animationDelay:(r-1)*.3+"s"})},null,4)),64))]),o("div",A,[o("div",{class:"progress-bar",style:k({width:a.uploadProgress+"%"})},null,4)]),o("div",G,E(Math.round(a.uploadProgress))+"% ",1)])])):y("",!0),e[7]||(e[7]=o("div",{class:"footer q-mt-xl text-center"},[o("p",{class:"text-caption text-grey-6"},[w(" Ð¡Ð¾ Ñ™ÑƒÐ±Ð¾Ð²,"),o("br"),w(" Ð’Ð°Ð»ÐµÐ½Ñ‚Ð¸Ð½Ð° & Ð‘ÐµÑ€Ðº ðŸ’• ")])],-1))]),_:1})}const $=S(R,[["render",W],["__scopeId","data-v-fda8f146"]]);export{$ as default};
